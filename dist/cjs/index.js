"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@aminbaghbanzadeh/chakra-file-uploader"),t=require("@chakra-ui/react"),n=require("react"),r=require("react-hook-form"),a=require("react-i18next"),l=require("@tinymce/tinymce-react"),o=require("axios"),i=require("react-select-async-paginate"),u=require("react-select/creatable"),c=require("@chakra-ui/icons"),d=require("@hookform/resolvers/yup"),f=require("react-query"),s=require("@aminbaghbanzadeh/chakra-tree-view"),m=require("yup");function p(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var v=p(n),h=p(o),g=p(u),b=function(){return(b=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function y(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}function E(e,t,n,r){return new(n||(n=Promise))((function(a,l){function o(e){try{u(r.next(e))}catch(e){l(e)}}function i(e){try{u(r.throw(e))}catch(e){l(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))}function C(e,t){var n,r,a,l,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function i(l){return function(i){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}}function S(e,t,n){if(n||2===arguments.length)for(var r,a=0,l=t.length;a<l;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}var w=n.forwardRef((function(e,n){var r=y(e,[]);return v.default.createElement(t.Checkbox,b({},r,{isChecked:r.checked,onChange:r.onChange,ref:n}),r.title)})),k=function(e){var t,n=y(e,[]);return v.default.createElement(l.Editor,b({},n.editorProps,{value:n.value,tinymceScriptSrc:process.env.PUBLIC_URL+"/tinymce.min.js",onEditorChange:function(e){return n.onChange(e)},init:b({directionality:"rtl",language:"fa",mobile:{menubar:!1,toolbar:"undo redo | formatselect | bold italic backcolor"},menubar:!1,height:300,toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat"},null===(t=n.editorProps)||void 0===t?void 0:t.init)}))},x=n.forwardRef((function(e,n){var r=y(e,[]);return v.default.createElement(t.NumberInput,b({ref:n},r,{size:"sm",inputMode:"numeric",min:0,max:1/0,value:r.value||0===r.value?r.value:""}),v.default.createElement(t.NumberInputField,{bg:"#F0F5F7",p:"6"}),v.default.createElement(t.NumberInputStepper,null,v.default.createElement(t.NumberIncrementStepper,null),v.default.createElement(t.NumberDecrementStepper,null)))})),P=function(e){var n=y(e,[]);return v.default.createElement(t.Center,{dir:"ltr"},v.default.createElement(t.HStack,null,v.default.createElement(t.PinInput,{otp:!0,onChange:function(e){return n.onChange(e)},isInvalid:n.isInvalid,autoFocus:!0,size:"lg"},S([],Array(n.count)).map((function(e,n){return v.default.createElement(t.PinInputField,{key:n})})))))},F=function(e){return{control:function(t,n){return b(b({},t),{padding:"0.2rem",backgroundColor:"#f0f5f7",border:"2px solid !impoetant",borderWidth:"2px !important",borderColor:e.isInvalid?"#e53e3e !important":n.isFocused?"#1967d2":"#E2E8F0 !important",borderRadius:"0.375rem","&hover":{borderColor:"#cbd5e0 !important"}})},input:function(e){return b(b({},e),{color:"#696969",fontSize:"0.875rem"})},valueContainer:function(e){return b(b({},e),{color:"#696969",fontSize:"0.875rem"})},indicatorSeparator:function(e){return b(b({},e),{display:"none"})},indicatorsContainer:function(e){return b(b({},e),{color:"black"})},option:function(e,t){return b(b({},e),{color:t.isSelected?"white":"black",padding:"0.2rem",paddingRight:"0.5rem",fontFamily:"inherit !important",fontSize:"0.875rem","&:hover":b(b({},e),{fontSize:"0.875rem",padding:"0.2rem",color:"white",backgroundColor:"#0385ff !important"}),"&:focus":b(b({},e),{fontSize:"0.875rem",padding:"0.2rem",color:"white",backgroundColor:"#0385ff !important"}),"&:active":b(b({},e),{fontSize:"0.875rem",padding:"0.2rem",color:"white",backgroundColor:"#0385ff !important"})})},loadingMessage:function(e,t){return b(b({},e),{fontSize:"0.875rem"})},noOptionsMessage:function(e,t){return b(b({},e),{fontSize:"0.875rem"})},multiValue:function(e,t){return b(b({},e),{background:"#d5e1f6",fontSize:"0.875rem",padding:"0.2rem 0.4rem"})}}},V=i.withAsyncPaginate(g.default),I=n.forwardRef((function(e,n){var r=y(e,[]),a=function(e,t){return E(void 0,void 0,void 0,(function(){var n,a,l,o;return C(this,(function(i){switch(i.label){case 0:return[4,h.default.get(""+r.fetchUrl+r.searchQueryFieldName+"="+e+"&"+(null!==(a=r.offsetQueryFieldName)&&void 0!==a?a:"SkipCount")+"="+t.length)];case 1:return[2,{options:(n=i.sent()).data[null!==(l=r.resultFieldName)&&void 0!==l?l:"items"],hasMore:n.data[null!==(o=r.totalCountFieldName)&&void 0!==o?o:"totalCount"]>t.length}]}}))}))};return r.isCreatable?v.default.createElement(V,b({styles:F(r),isRtl:!0},r,{isClearable:!0,isSearchable:!0,selectRef:n,defaultValue:r.value,loadOptions:a,placeholder:"انتخاب کنید.",noOptionsMessage:function(e){return"گزینه ای مرتبط با "+e.inputValue+" یافت نشد."},loadingMessage:function(){return"در حال بارگزاری..."},onChange:function(e,t){return r.onChange(e,t)},components:{LoadingIndicator:function(){return v.default.createElement(t.Spinner,{size:"sm",colorScheme:"blue"})}},debounceTimeout:1,formatCreateLabel:function(e){return v.default.createElement(t.HStack,null,v.default.createElement(c.SearchIcon,null),v.default.createElement(t.Text,null,'"',e,'"'))}})):v.default.createElement(i.AsyncPaginate,b({styles:F(r)},r,{isClearable:!0,isSearchable:!0,selectRef:n,defaultValue:r.value,loadOptions:a,placeholder:"انتخاب کنید.",debounceTimeout:1,noOptionsMessage:function(e){return"گزینه ای مرتبط با "+e.inputValue+" یافت نشد."},loadingMessage:function(){return"در حال بارگزاری..."},onChange:function(e,t){return r.onChange(e,t)},components:{LoadingIndicator:function(){return v.default.createElement(t.Spinner,{size:"sm",colorScheme:"blue"})}}}))})),T=function(e){var r,a=y(e,[]),l=n.useState(null!==(r=a.defaultValue)&&void 0!==r?r:[10,100]),o=l[0],i=l[1];return v.default.createElement(v.default.Fragment,null,v.default.createElement(t.RangeSlider,b({"aria-label":["min","max"],min:a.min,max:a.max,defaultValue:a.defaultValue},a,{width:"full",onChangeEnd:function(e){i(e),a.onChange(e)},onChange:function(e){i(e)},size:"md"}),v.default.createElement(t.RangeSliderTrack,null,v.default.createElement(t.RangeSliderFilledTrack,null)),v.default.createElement(t.RangeSliderThumb,{index:0,width:16,height:6},v.default.createElement(t.Box,{color:"primary.500",fontSize:"2xs"},"حداقل (",o[0],")")),v.default.createElement(t.RangeSliderThumb,{index:1,width:16,height:6},v.default.createElement(t.Box,{color:"primary.500",fontSize:"2xs"},"حداکثر (",o[1],")"))))},z=function(e){var n=y(e,[]);return v.default.createElement(t.Switch,{onChange:n.onChange})},R=function(e){var n=y(e,[]);return v.default.createElement(t.Textarea,b({},n,{bg:"#F0F5F7"}))},M=n.forwardRef((function(e,n){var r=y(e,[]);return v.default.createElement(t.Input,b({_focus:{bg:"white",border:"1px solid #1967D2"}},r,{onChange:r.onChange,ref:n,value:r.value||"",bg:"#f0f5f7",p:"6",color:"#696969"}))})),O=function(e,t,r,a){var l=n.useState(null),o=l[0],i=l[1];return n.useEffect((function(){a&&function(e,t,n){var r=document.getElementById(e);if(r){var a=window.grecaptcha;i(a)}else{var l=document.createElement("script");l.type="text/javascript",l.src=t,l.id=e,l.onload=function(){var e=window.grecaptcha;e.ready((function(){i(e)}))},document.body.appendChild(l)}r&&n&&n()}("recaptcha-key","https://www.google.com/recaptcha/api.js?render="+t,(function(){}))}),[e]),[n.useCallback((function(){return E(void 0,void 0,void 0,(function(){return C(this,(function(e){switch(e.label){case 0:if(!o||!o.execute)throw new Error("Google Recaptcha has not been loaded");return[4,o.execute(t,{action:"submit"})];case 1:return[2,e.sent()]}}))}))}),[o])]},A=v.default.createContext(void 0);function j(){var e=v.default.useContext(A);if(void 0===e)throw new Error("useAminook must be used within a FormBuilder Tag");return e}var q=function(){return v.default.createElement(t.Skeleton,{h:"12",w:"full",borderRadius:"8px"})},D=n.forwardRef((function(e,n){var r=y(e,[]);return r.options?v.default.createElement(L,b({ref:n},r)):r.fetchUrl?v.default.createElement(N,b({ref:n},r)):v.default.createElement(t.Select,null)})),L=n.forwardRef((function(e,n){var r,a=y(e,[]);return v.default.createElement(t.Select,b({},a,{ref:n,onChange:a.onChange,bg:"#F0F5F7",size:"lg",fontSize:"sm"}),null===(r=a.options)||void 0===r?void 0:r.map((function(e){return v.default.createElement("option",{value:e.value,key:e.value},e.label)})))})),N=n.forwardRef((function(e,t){var n=y(e,[]),r=f.useQuery(n.fetchUrl,(function(){return h.default.get(n.fetchUrl).then((function(e){return e.data}))}),{select:function(e){return e.items.map((function(e){return{label:n.labelProperty?e[n.labelProperty]:e.label,value:n.valueProperty?e[n.valueProperty]:e.value}}))}}),a=r.data;return r.isLoading?v.default.createElement(q,null):v.default.createElement(L,b({ref:t,options:a},n))})),B=n.forwardRef((function(e,t){var r,a,l=y(e,[]),o=n.useState(),i=o[0],u=o[1],c=n.useState(null!==(r=l.value)&&void 0!==r?r:[]),d=c[0],f=c[1],s=n.useCallback((function(e){u(e)}),[]),m=n.useCallback((function(e){if(i)switch(e.key){case"Enter":case"Tab":e.preventDefault(),e.stopPropagation(),u(""),f((function(e){return S(S([],e),[{label:i,value:i}])})),l.onChange(d.map((function(e){return e.value})).concat(i).join(",")),u("")}}),[i]),p=n.useCallback((function(e,t){l.onChange(e.map((function(e){return e.value})).join(",")),f(e)}),[f]);return v.default.createElement(g.default,b({styles:F(l)},l,{ref:t,placeholder:null!==(a=l.placeholder)&&void 0!==a?a:"انتخاب کنید.",components:{DropdownIndicator:null},inputValue:i,isMulti:!0,menuIsOpen:!1,onChange:p,onInputChange:s,onKeyDown:m,value:d}))})),U=function(e){var n=y(e,[]);console.log(n);var r=t.useDisclosure(),a=r.isOpen,l=r.onToggle,o=f.useQuery(n.fetchUrl,(function(){return h.default.get(n.fetchUrl,{headers:b({},n.requestHeaders)}).then((function(e){return e}))}),{enabled:!!n.fetchUrl}),i=o.data;return o.isLoading,v.default.createElement(v.default.Fragment,null,!n.inline&&v.default.createElement(t.Button,b({onClick:l},n.btnProps),n.btnText),v.default.createElement(t.Collapse,{in:!!n.inline||a,animateOpacity:!0},v.default.createElement(s.Tree,b({},n,{data:n.data?n.data:n.treeDataTransformer(i)}))))},H=function(e){var n=e.width;return v.default.createElement(t.Skeleton,{h:"12",w:n||"full",borderRadius:"8px"})},_=function(){return v.default.createElement(t.HStack,{spacing:"2"},v.default.createElement(t.Skeleton,{h:"5",rounded:"sm",w:"5"}),v.default.createElement(t.Skeleton,{h:"5",rounded:"sm",w:"40"}))},W=function(){return v.default.createElement(t.Skeleton,{h:"28",w:"full"})},Q=function(){return"ontouchstart"in window||navigator.maxTouchPoints>0};function G(e,t){switch(t.type){case"PointerMove":return b(b({},e),{hoverValue:t.payload});case"PointerLeave":return{defaultValue:e.defaultValue,hoverValue:null};case"MouseClick":return b(b({},e),{defaultValue:t.payload});default:return e}}function K(e){var r,a=e.onClick,l=e.initialValue,o=void 0===l?0:l,i=e.ratingValue,u=void 0===i?0:i,d=e.iconsCount,f=void 0===d?5:d,s=e.size,m=void 0===s?20:s,p=e.readonly,h=void 0!==p&&p,g=e.fillColor,y=void 0===g?"#ffbc0b":g,E=e.fillColorArray,C=void 0===E?[]:E,w=e.emptyColor,k=void 0===w?"#cccccc":w,x=e.fullIcon,P=void 0===x?null:x,F=e.emptyIcon,V=void 0===F?null:F,I=e.customIcons,T=void 0===I?[]:I,z=e.rtl,R=void 0!==z&&z,M=e.allowHalfIcon,O=void 0!==M&&M,A=e.allowHover,j=void 0===A||A,q=e.transition,D=void 0!==q&&q,L=e.className,N=void 0===L?"react-simple-star-rating":L,B=e.style,U=e.fullClassName,H=void 0===U?"filled-icons":U,_=e.emptyClassName,W=void 0===_?"empty-icons":_,K=e.fullStyle,X=e.emptyStyle,$=e.showTooltip,J=void 0!==$&&$,Y=e.tooltipDefaultText,Z=void 0===Y?"امتیاز":Y,ee=e.tooltipArray,te=void 0===ee?[]:ee;e.tooltipClassName,e.tooltipStyle;var ne=n.useReducer(G,{defaultValue:u,hoverValue:null}),re=ne[0],ae=re.defaultValue,le=re.hoverValue,oe=ne[1];v.default.useEffect((function(){return oe({type:"MouseClick",payload:u})}),[u]);var ie=function(e){var t=e.clientX,n=e.currentTarget.children[0].getBoundingClientRect(),r=n.left,a=n.right,l=n.width,o=function(e,t,n){for(var r=100/e,a=n/e,l=100,o=0;o<e;o+=1)if(t<=a*o+a/4){l=0===o&&t<a/2?0:r*o;break}return l}(fe,R?a-t:t-r,l);o>0&&le!==o&&oe({type:"PointerMove",payload:o})},ue=function(){le&&(oe({type:"MouseClick",payload:le}),a&&a(le/20))},ce=n.useMemo((function(){return Math.round(o/f*100)}),[o,f]),de=n.useMemo((function(){return j&&le&&le||ae&&ae||ce}),[j,le,ae,ce]),fe=n.useMemo((function(){return O?2*f:f}),[O,f]),se=n.useCallback((function(e){var t=1;return e&&(t=O?e/fe:e/2/10),Math.round(t-1)}),[O,fe]),me=n.useCallback((function(e){return O?e/2/10:se(e)+1}),[O,se]),pe=function(e){return te.length>0?te[se(e)]:me(e)||0};return v.default.createElement(t.Tooltip,{isDisabled:!J,label:le&&pe(le)||ae&&pe(ae)||ce&&pe(ce)||Z},v.default.createElement("span",{style:{display:"inline-block",direction:R?"rtl":"ltr",touchAction:"none",position:"relative"}},v.default.createElement("span",{className:N,style:b({position:"relative",display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",cursor:h?"":"pointer",verticalAlign:"middle",userSelect:"none"},B),onPointerMove:h?void 0:ie,onPointerEnter:h?void 0:function(e){Q()&&ie(e)},onPointerLeave:h?void 0:function(){Q()&&ue(),oe({type:"PointerLeave"})},onClick:h?void 0:ue,"aria-hidden":"true"},v.default.createElement("span",{className:W,style:b({display:"inline-block",color:k},X)},S([],Array(f)).map((function(e,t){var r;return v.default.createElement(n.Fragment,{key:t},(null===(r=T[t])||void 0===r?void 0:r.icon)||V||v.default.createElement(c.StarIcon,{key:t,boxSize:null!=m?m:{base:5,md:8,lg:10},style:{display:"inline-block"}}))}))),v.default.createElement("span",{className:H,style:b((r={position:"absolute",top:0},r[R?"right":"left"]=0,r.color=j&&le&&C[se(le)]||ae&&C[se(ae)]||y,r.overflow="hidden",r.whiteSpace="nowrap",r.display="inline-block",r.transition=D?"width .2s ease, color .2s ease":"",r.width=de+"%",r),K)},S([],Array(f)).map((function(e,t){var r;return v.default.createElement(n.Fragment,{key:t},(null===(r=T[t])||void 0===r?void 0:r.icon)||P||v.default.createElement(c.StarIcon,{boxSize:null!=m?m:{base:5,md:8,lg:10},display:"initial",style:{display:"inline-block"}}))}))))))}var X=n.forwardRef((function(n,l){var o,i,u,c,d,f,s,m,p,h=y(n,[]),g=a.useTranslation("validations")[0],E=j(),C=E.translation,S=E.router,F=E.formSchema,V=E.isDefaultValueFetching,O=r.useFormContext().setValue,A=F.fields[h.name],L=null!==(o=null==A?void 0:A.meta)&&void 0!==o?o:h.fieldSetting,N={name:h.name,value:h.value};return v.default.createElement(t.Box,{my:h.my,mx:h.mx,display:"inline-block",w:{base:null!==(u=null===(i=h.width)||void 0===i?void 0:i.base)&&void 0!==u?u:"full",md:null!==(d=null===(c=h.width)||void 0===c?void 0:c.md)&&void 0!==d?d:"full"}},v.default.createElement(t.FormControl,{display:h.hidden?"none":"initial",isInvalid:!!h.error,isRequired:null!==(f=null==A?void 0:A.tests.some((function(e){return"required"===e.name})))&&void 0!==f&&f},!(null==L?void 0:L.hideLabel)&&"checkbox"!==L.type&&v.default.createElement(t.FormLabel,{htmlFor:h.name,fontSize:"sm",fontWeight:"bold",color:V?"gray.300":"#202124"},(null==A?void 0:A.label)?null==A?void 0:A.label:(null===(s=null==h?void 0:h.fieldSetting)||void 0===s?void 0:s.label)?null===(m=null==h?void 0:h.fieldSetting)||void 0===m?void 0:m.label:C((S?null==S?void 0:S.pathname:window.location.pathname)+".form.labels."+h.name)),function(){var n,r,a,o,i,u;switch(null!==(n=null==L?void 0:L.type)&&void 0!==n?n:null===(r=h.fieldSetting)||void 0===r?void 0:r.type){case"input-text":case"input-mask":return V?v.default.createElement(H,{width:null===(a=(null==L?void 0:L.fieldProps).width)||void 0===a?void 0:a.toString()}):v.default.createElement(M,b({ref:l},b(b({},N),null==L?void 0:L.fieldProps),{onChange:function(e){h.onChange(function(e){var t=[/۰/g,/۱/g,/۲/g,/۳/g,/۴/g,/۵/g,/۶/g,/۷/g,/۸/g,/۹/g],n=[/٠/g,/١/g,/٢/g,/٣/g,/٤/g,/٥/g,/٦/g,/٧/g,/٨/g,/٩/g];if("string"==typeof e)for(var r=0;r<10;r++)e=e.replace(t[r],r.toString()).replace(n[r],r.toString());return e}(e.target.value))}}));case"input-number":return V?v.default.createElement(H,{width:null===(o=(null==L?void 0:L.fieldProps).width)||void 0===o?void 0:o.toString()}):v.default.createElement(x,b({ref:l},b(b({},N),null==L?void 0:L.fieldProps),{onChange:function(e,t){h.onChange(t)}}));case"checkbox":return V?v.default.createElement(_,null):v.default.createElement(w,b({ref:l},null==L?void 0:L.fieldProps,N,{checked:N.value,title:null==A?void 0:A.label,onChange:function(e){return h.onChange(e.target.checked,e)}}));case"select":return V?v.default.createElement(q,null):v.default.createElement(D,b({ref:l},null==L?void 0:L.fieldProps,N,{onChange:function(e){return h.onChange(e.target.value,e)}}));case"switch":return v.default.createElement(z,b({},N,null==L?void 0:L.fieldProps,{onChange:function(e){return h.onChange(e.target.checked)}}));case"text-area":return V?v.default.createElement(W,null):v.default.createElement(R,b({},N,null==L?void 0:L.fieldProps,{onChange:function(e){return h.onChange(e.target.value,e)}}));case"slider":return v.default.createElement(T,b({},h,null==L?void 0:L.fieldProps,{onChange:function(e){h.name.split("_").forEach((function(t,n){return O(""+t,e[n])}))}}));case"input-pin":return v.default.createElement(P,b({},N,null==L?void 0:L.fieldProps,{isInvalid:!!h.error,onChange:function(e){return h.onChange(e)}}));case"editor":return v.default.createElement(k,b({},null==L?void 0:L.fieldProps,{value:h.value,onChange:function(e){return h.onChange(e)}}));case"uploader":return v.default.createElement(e.ChakraFileUploader,b({},null==L?void 0:L.fieldProps));case"reach-select":return V?v.default.createElement(q,null):v.default.createElement(I,b({ref:l},null==L?void 0:L.fieldProps,{isInvalid:!!h.error,isDisabled:null==L?void 0:L.isDisabled},N,{onChange:function(e){h.onChange(e)}}));case"input-tag":return V?v.default.createElement(H,null):v.default.createElement(B,b({ref:l},null==L?void 0:L.fieldProps,{isInvalid:!!h.error},N,{onChange:function(e){h.onChange(e)},value:h.value?null===(u=null===(i=h.value)||void 0===i?void 0:i.split(","))||void 0===u?void 0:u.map((function(e){return{value:e,label:e}})):void 0}));case"tree-view":return v.default.createElement(U,b({},null==L?void 0:L.fieldProps,N,{onChange:function(e){h.onChange(e)},defaultSelected:h.value}));case"star-picker":return v.default.createElement(K,b({},null==L?void 0:L.fieldProps,N,{onClick:function(e){h.onChange(e)},initialValue:h.value}));default:return v.default.createElement(t.Box,null,"Unrecognized field type.")}}(),!!(null==L?void 0:L.helperText)&&v.default.createElement(t.FormHelperText,{fontSize:"xs"},null==L?void 0:L.helperText),!!h.error&&v.default.createElement(t.FormErrorMessage,{fontSize:"xs"},C?g(h.error.type,{path:C((S?S.pathname:window.location.pathname)+".form.labels."+h.name),value:h.value}):null===(p=h.error)||void 0===p?void 0:p.message)))})),$=[/۰/g,/۱/g,/۲/g,/۳/g,/۴/g,/۵/g,/۶/g,/۷/g,/۸/g,/۹/g],J=[/٠/g,/١/g,/٢/g,/٣/g,/٤/g,/٥/g,/٦/g,/٧/g,/٨/g,/٩/g],Y=m.string().transform((function(e,t){return m.string().isType(e)&&null!==e?function(e){if("string"==typeof e)for(var t=0;t<10;t++)e=e.replace($[t],""+t).replace(J[t],""+t);return e}(e):e}));exports.ControlledFormControl=function(e){var t=y(e,[]),n=j().control;return v.default.createElement(r.Controller,{name:t.name,control:n,render:function(e){var n=e.field,r=e.fieldState;return e.formState,v.default.createElement(X,b({error:r.error},b(b(b({},t),r),n)))}})},exports.FormBuilder=function(e){var a,l=this,o=t.useToast({position:"top",isClosable:!0,variant:"top-accent"}),i=O("recaptcha-key",e.recaptchaApiKey,0,null!==(a=e.doesHaveRecaptcha)&&void 0!==a&&a)[0],u=e.formSchema.describe(),c=f.useMutation(e.mutationFunction,{retry:0}),s=r.useForm({mode:"onSubmit",resolver:d.yupResolver(e.formSchema),defaultValues:e.defaultValues?e.defaultValues:void 0});return n.useEffect((function(){s.reset(e.defaultValues)}),[e.defaultValues,s.reset]),v.default.createElement(A.Provider,{value:{formSchema:u,control:s.control,translation:e.translation,router:e.router,isLoading:c.isLoading,isError:c.isError,isDefaultValueFetching:e.isDefaultValueFetching}},v.default.createElement(r.FormProvider,b({},s),v.default.createElement("form",{noValidate:!0,style:{width:"100%"},onSubmit:s.handleSubmit((function(t){return E(l,void 0,void 0,(function(){var n;return C(this,(function(r){switch(r.label){case 0:return e.onSubmitSucess?(e.onSubmitSucess(t),[2]):e.doesHaveRecaptcha?[4,i()]:[3,2];case 1:n=r.sent(),t=b(b({},t),{captchaToken:n}),r.label=2;case 2:return c.mutate(t,{onSuccess:function(n){e.showToastOnSuccess&&o({title:e.successToastMessage,status:"success"}),e.onMutateSucess&&e.onMutateSucess(n.data,t)},onError:function(t){e.onMutateError&&e.onMutateError(t),o({title:t.code,description:t.message,status:"error"})}}),[2]}}))}))}),(function(t){e.onSubmitError&&e.onSubmitError(t)}))},e.children)))},exports.FormControl=X,exports.FormSubmitButton=function(e){var a,l,o;e.type;var i=e.text;e.onClick;var u=y(e,["type","text","onClick"]),c=j(),d=c.isLoading,f=c.isDefaultValueFetching,s=r.useFormContext().formState,m=t.useDisclosure(),p=m.isOpen,h=m.onToggle;return n.useEffect((function(){console.log(s.errors)}),[s]),v.default.createElement(t.HStack,{spacing:"6",mt:u.mt?u.mt:"6"},v.default.createElement(t.Button,b({isLoading:d,loadingText:"در حال ذخیره اطلاعات...",type:"submit",variant:"primary_dark",fontSize:"sm"},u,{disabled:f||d}),i),(null===(a=Object.keys(s.errors))||void 0===a?void 0:a.length)>0&&v.default.createElement(t.Button,{fontSize:"sm",onClick:h,variant:"outline",colorScheme:"red"},"مشاهده مشکلات"),v.default.createElement(t.Collapse,{in:p&&(null===(l=Object.keys(s.errors))||void 0===l?void 0:l.length)>0,animateOpacity:!0},v.default.createElement(t.Alert,{status:"error",variant:"top-accent",flexDirection:"column",alignItems:"start",justifyContent:"start",textAlign:"right",p:"6"},v.default.createElement(t.AlertIcon,{boxSize:"40px",mr:0}),v.default.createElement(t.AlertTitle,{mt:4,mb:1,fontSize:"sm"},"ثبت اطلاعات پس از رفع مشکلات زیر امکانپذیر است."),v.default.createElement(t.AlertDescription,{maxWidth:"sm"},v.default.createElement(t.UnorderedList,null,null===(o=Object.keys(s.errors))||void 0===o?void 0:o.map((function(e,n){return v.default.createElement(t.ListItem,{key:n},v.default.createElement(t.HStack,null,v.default.createElement(t.Text,{fontWeight:"bold",fontSize:"sm"},e),v.default.createElement(t.Text,{fontSize:"xs"},s.errors[e].message)))})))))))},exports.Select=D,exports.inherentNumberString=Y,exports.mobileIranValidation=/09(1[0-9]|3[1-9]|2[1-9])-?[0-9]{3}-?[0-9]{4}/,exports.phoneNumberIranValidation=/^0[0-9]{2,}[0-9]{7,}$/,exports.selectWithValueExtractor=function(){return m.number().transform((function(e,t){return e?e.value:t?t.value:null}))},exports.useAminook=j;
//# sourceMappingURL=index.js.map
